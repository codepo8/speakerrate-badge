<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
 "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  
  <title></title>
  <!-- <link rel="stylesheet" href="http://yui.yahooapis.com/2.7.0/build/ reset-fonts-grids/reset-fonts-grids.css" type="text/css">
  <link rel="stylesheet" href="http://yui.yahooapis.com/2.7.0/build/ base/base.css" type="text/css"> -->
</head>
<body>
<div id="doc" class="yui-t7">
  <div id="hd" role="banner"><h1></h1></div>
  <div id="bd" role="main">
    <div id="speakerratebadge"><a href="http://speakerrate.com/speakers/3543-christian-heilmann" id="speakerratelink" href="http://speakerrate.com/speakers/3543-christian-heilmann">Rate me on Speakerrate</a></div>
  </div>
  <div id="ft" role="contentinfo"><p></p></div>
</div>
<script type="text/javascript">
speakerratebadge = function(){
  var config = {
    badgeID:'speakerratebadge',
    linkID:'speakerratelink',
    headerText:'Latest Comments',
    amount:10,
    styled:true
  }
  var badge = document.getElementById(config.badgeID);
  var link = document.getElementById(config.linkID);
  function init(o){
    if(o && o.headerText){
      config.headerText = o.headerText;
    }
    if(o && o.amount){
      config.amount = o.amount;
    }
    if(o && o.styled){
      config.styled = o.styled;
    }
    if(badge && link){
      var speakerurl = link.getAttribute('href');
      var url ='http://query.yahooapis.com/v1/public/yql?q=select%20comment.comment%2Ccomment.talk.id%2Ccomment.talk.title%2Ccomment.commenter.name%2Ccomment.comment%20from%20xml%20where%20url%3D%22'+encodeURIComponent(speakerurl)+'%2Fcomments.xml%22&format=json&diagnostics=false&callback=speakerratebadge.seed';
      var s = document.createElement('script');
      s.setAttribute('src',url);
      document.getElementsByTagName('head')[0].appendChild(s);
      if(config.styled){
        var st = document.createElement('link');
        st.setAttribute('type','text/css');
        st.setAttribute('rel','stylesheet');
        st.setAttribute('href','foo');
        document.getElementsByTagName('head')[0].appendChild(st);
      }
      
    }
  };
  function seed(o){
    var out = '<h4>'+config.headerText+'</h4><ul>';
    if(o.query && o.query.results && o.query.results.comments){
      var all = Math.min(o.query.results.comments.length,config.amount);
      for(var i=0,j=all;i<j;i++){
        var cur = o.query.results.comments[i];
        out += '<li><strong>'+cur.comment.commenter.name+'</strong>: '+cur.comment.comment+'<span> (about <a href="http://speakerrate.com/talks/'+cur.comment.talk.id.content+'-'+cur.comment.talk.title.toLowerCase().replace(/ /g,'-')+'">'+cur.comment.talk.title+'</a>)</span></li>';
      }
    }
    out += '</ul>';
    badge.innerHTML += out;
  };
  return{seed:seed,init:init}
}();
speakerratebadge.init();
</script>

</body>
</html>
